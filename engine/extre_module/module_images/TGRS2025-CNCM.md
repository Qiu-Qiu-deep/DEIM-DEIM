# CNCM

## 1. 动机

### 现有方法的问题
- **全局列特征建模不足**：虽然注意力机制和列校准模块已被应用于去条纹任务，但它们的有效性受限于缺乏对列长程依赖的显式建模 [3]
- **无法充分探索列模式**：现有方法难以在全局上下文中探索和调制特征列模式，阻碍了对条纹噪声的精确识别 [3]
- **区分能力有限**：缺乏有效的全局列特征增强机制，难以将条纹噪声与场景的垂直结构区分开 [3]

### 提出模块的目的
设计CNCM（列非均匀性校正模块，Column Nonuniformity Correction Module）来解决上述挑战 [3]：
- **捕捉全局列关系**：在长程依赖中有效捕捉列关系
- **建立全局上下文**：通过整合列、空间和自相依信息，充分建立全局上下文
- **增强区分能力**：更好地区分条纹噪声和场景的垂直结构

## 2. 模块工作原理和核心思想

### 整体架构设计

CNCM采用**嵌套式结构**，将RCSSC（残差列空间自校正）块嵌入到DCR（密集连接残差）结构中 [10]：

```
CNCM = DCR + RCSSC
```

**设计理念**：
- **DCR结构**：引入特征重用和增强信息流，借鉴密集连接网络的优势 [10]
- **RCSSC块**：在DCR基础上添加残差连接，形成核心的列空间自校正功能 [10]

### 核心组件：RCSSC块

RCSSC块将残差连接整合到CSSC（列空间自校正）块中，CSSC由三个分支组成 [10][11]：

#### **三分支协同机制**

**数学表达式** [9]：
```
Co = f1×1([SAB(X), CAB(X)]) ⊙ SCB(X) + X
   = f1×1([SA, CA]) ⊙ SC + X
```

其中：
- `X ∈ R^(C×H×W)`：输入特征
- `Co ∈ R^(C×H×W)`：输出特征
- `SAB`、`CAB`、`SCB`：三个核心分支
- `⊙`：广播哈达玛积

#### **(1) 列注意力分支（CAB）**

**核心思想**：强化列特征以克服条纹噪声的列差异 [3][10]

**创新设计**：
- **双列池化策略**：应用列平均池化和列最大池化（池化核大小为(H,1)）到输入特征的每一列 [11]
- **原理**：由于同一列的像素共享相同的放大器，应被赋予相似的校正系数以强调列依赖性 [11]

**工作流程** [11]：
```
步骤1：双列池化
Mc = [f_Avg^column(X), f_Max^column(X)]  // Mc ∈ R^(2C×1×W)

步骤2：特征交互与分割
Xa, Xm = Chunk2(CBL(Mc))

步骤3：生成列注意力权重
CA = X ⊙ F_Avg^column(Xa) ⊙ F_Max^column(Xm)
```

**优势**：
- 全局池化捕捉更丰富的高层信息 [11]
- 双重校正机制实现精细的列特征调制
- 相比传统CCM模块，PSNR提升0.30 dB [18]

#### **(2) 空间注意力分支（SAB）**

**核心思想**：增强空间相关性，突出关键区域的结构特征以解耦条纹噪声 [3][10]

**工作原理** [10]：
```
SA = f_s^(3×3)([f_Avg^spatial(X), f_Max^spatial(X)]) ⊙ X
```

**流程**：
1. 沿通道维度进行全局平均池化和最大池化，捕捉不同的语义响应
2. 拼接后通过3×3卷积和sigmoid激活获得空间权重
3. 与输入特征相乘生成空间增强特征

**作用**：帮助网络关注包含重要信息的空间区域，提升结构表征能力 [11]

#### **(3) 自校准分支（SCB）**

**核心思想**：建立灵活的远程依赖关系，聚合上下文信息以微调全局均匀性 [3][10]

**工作机制** [11]：
```
SC = δ_s(X + B2(conv(A2(X))))
```

其中：
- `A2(·)`：2×2平均池化（步长为2）
- `B2(·)`：双线性插值放大2倍
- `δ_s`：激活函数

**优势**：
- 实现强大的上下文信息建模
- 在每个空间位置建立长程依赖关系 [11]
- 灵活聚合列的全局上下文信息 [10]

### 融合与输出机制

**三分支融合策略** [9]：
1. **空间-列融合**：将SA和CA沿通道维度拼接后通过1×1卷积降维
2. **自校准调制**：融合结果与SC进行逐元素乘法
3. **残差连接**：添加输入X保持信息流

### 在网络中的应用

CNCM被战略性地部署在ASCNet的编码和解码阶段 [9]：
- **编码阶段**：在每次RHDWT下采样后应用CNCM进行特征增强
- **解码阶段**：在特征融合后应用CNCM，精细分离条纹噪声并捕捉纹理细节
- **作用时机**：每次采样后捕捉列关系的长程依赖 [3]

## 3. 总结

### 核心贡献

CNCM通过**嵌套式三分支协同机制**实现了全局列特征的有效建模：

1. **列均匀性建模**（CAB）：
   - 双列池化捕捉列的全局响应
   - 双重校正机制精确调制列特征
   - 有效克服条纹噪声的列间差异

2. **空间相关性增强**（SAB）：
   - 突出关键区域的结构特征
   - 帮助解耦条纹噪声与垂直背景细节

3. **长程依赖建立**（SCB）：
   - 灵活聚合全局上下文信息
   - 微调不同特征层之间的全局均匀性

### 实验验证

**消融实验结果** [18]：
- 移除空间注意力分支：PSNR下降0.83 dB
- 移除自校准分支：PSNR下降0.34 dB
- 相比传统CCM：PSNR提升0.30 dB

**视觉效果** [18]：
- CSSC在条纹噪声去除方面表现最优
- 更好地保留图像细节，减少模糊

### 技术意义

CNCM成功解决了红外图像去条纹任务中的**全局列特征建模难题**，通过整合列、空间和自相依信息，在全局上下文中建立了完整的列关系表征，为ASCNet实现优异的去条纹性能提供了关键支撑 [3][10]。该模块的设计思想对其他需要处理列式噪声的图像处理任务也具有重要参考价值。