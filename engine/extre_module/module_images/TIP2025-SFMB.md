# SFMB模块

## 一、动机

### 现有方法的问题
1. **Mamba缺乏完整的空间感知能力**：
   - 原始Mamba只能在单一尺度提取特征，导致多尺度信息丢失[7]
   - Mamba的扫描操作沿着特征的高度和宽度方向进行，难以建模通道间信息[8]

2. **Mamba缺乏频率域感知能力**：
   - 空间域主要包含低频信息，但在多模态图像融合中，低频信息（如全局内容）和高频信息（如局部细节）都很重要[9]
   - Mamba缺乏有效处理频率域信息的能力[9]

### 提出模块的目的
设计空间-频率增强Mamba块（SFMB）来全面增强Mamba在空间域和频率域的感知能力，从而提取更全面的特征用于多模态图像融合[3][5]。

---

## 二、模块工作原理和核心思想

SFMB由三个关键子模块组成，分别从不同维度增强Mamba的特征提取能力[5][7]：

### 1. 混合尺度Mamba块（MMB）- 空间维度增强

**核心思想**：通过多尺度特征提取增强Mamba在空间域的空间维度感知[7]

**工作原理**：
- **第一流**：输入特征M经过线性层、3×3深度卷积和SiLU激活生成M1
- 通过下采样层逐步生成M2和M3，获取不同尺度的特征[7]
- 使用2D-SSM（二维选择性扫描模块）和层归一化精炼各尺度特征
- 通过上采样层将特征恢复到原始尺寸[7]
- **第二流**：通过线性层和SiLU激活处理输入M，生成Mg[7]
- **融合**：通过元素级乘法融合两个流的输出，再经过线性层和跳跃连接得到最终输出[7]

**优势**：能够同时捕捉细粒度细节和高层语义信息[7]

### 2. 通道增强块（CEB）- 通道维度增强

**核心思想**：增强Mamba在空间域的通道维度建模能力[8]

**工作原理**：
- 输入特征S先经过3×3卷积得到Sc
- 将Sc沿通道维度分割为两部分：Sa和Sm[8]
- **第一流（Sa）**：使用全局平均池化（GAP）→ 1×1卷积+ReLU → 1×1卷积+Sigmoid → 与Sa元素级乘法
- **第二流（Sm）**：使用全局最大池化（GMP）→ 1×1卷积+ReLU → 1×1卷积+Sigmoid → 与Sm元素级乘法[8]
- 通过通道混洗整合两个增强流，结合跳跃连接生成输出[8][9]

**优势**：同时考虑通道间的平均响应和最大响应，更好地建模通道级信息[9]

### 3. 频率增强块（FEB）- 频率域增强

**核心思想**：增强Mamba在频率域的感知能力[9]

**工作原理**：
- 通过快速傅里叶变换（FFT）将输入Z转换到频率域
- 分解为幅度谱Za和相位谱Zp[9]
- **第一流（幅度谱）**：使用两个1×1卷积层+ReLU激活处理Za，得到Za'（处理高频细节）
- **第二流（相位谱）**：使用3×3卷积层+ReLU激活处理Zp，得到Zp'（处理结构信息）[9]
- 通过逆快速傅里叶变换（IFFT）将Za'和Zp'转换回空间域
- 结合跳跃连接生成最终输出[9]

**优势**：分别处理幅度谱和相位谱，能够更好地处理不同类型的信息[9]

### 整体工作流程
给定输入X，SFMB的输出计算过程为[5]：
1. 先对输入进行层归一化：X̄ = LN(X)
2. 并行通过三个子模块：Xout = MMB(X̄) + CEB(X̄) + FEB(X̄)

---

## 三、总结

SFMB模块通过三个互补的子模块全面增强了Mamba的特征提取能力[5][7]：

1. **MMB**在空间域的空间维度上，通过多尺度特征提取捕捉从细粒度细节到高层语义的全面信息

2. **CEB**在空间域的通道维度上，通过双流池化策略增强通道间信息建模能力

3. **FEB**在频率域上，通过分别处理幅度谱和相位谱，同时捕捉高频细节和结构信息

这三个模块的协同作用使得SFMB能够从空间-频率多个维度提取更全面、更丰富的特征，为多模态图像融合提供了强大的特征表示能力。实验证明，移除任何一个子模块都会导致性能下降，验证了每个组件的必要性和有效性[19]。